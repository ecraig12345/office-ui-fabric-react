<!DOCTYPE html>
<html dir="ltr">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" user-scalable="no" />
    <title>Microsoft UI Fabric</title>
    <link href="https://c.s-microsoft.com/favicon.ico?v2" rel="shortcut icon" type="image/x-icon" />
    <style>
      body,
      html {
        margin: 0;
        padding: 0;
      }

      .loading {
        align-items: center;
        background-color: #faf9f8;
        display: flex;
        height: 100vh;
        justify-content: center;
      }
    </style>
    <script type="text/javascript">
      var appInsights =
        window.appInsights ||
        (function(a) {
          function b(a) {
            c[a] = function() {
              var b = arguments;
              c.queue.push(function() {
                c[a].apply(c, b);
              });
            };
          }
          var c = { config: a },
            d = document,
            e = window;
          setTimeout(function() {
            var b = d.createElement('script');
            (b.src = a.url || 'https://az416426.vo.msecnd.net/scripts/a/ai.0.js'),
              d.getElementsByTagName('script')[0].parentNode.appendChild(b);
          });
          try {
            c.cookie = d.cookie;
          } catch (a) {}
          c.queue = [];
          for (var f = ['Event', 'Exception', 'Metric', 'PageView', 'Trace', 'Dependency']; f.length; ) b('track' + f.pop());
          if (
            (b('setAuthenticatedUserContext'),
            b('clearAuthenticatedUserContext'),
            b('startTrackEvent'),
            b('stopTrackEvent'),
            b('startTrackPage'),
            b('stopTrackPage'),
            b('flush'),
            !a.disableExceptionTracking)
          ) {
            (f = 'onerror'), b('_' + f);
            var g = e[f];
            e[f] = function(a, b, d, e, h) {
              var i = g && g(a, b, d, e, h);
              return !0 !== i && c['_' + f](a, b, d, e, h), i;
            };
          }
          return c;
        })({
          instrumentationKey: '18e07455-6fee-47f7-ab59-8dbf99a31d23'
        });

      // @TODO: Add custom referrer tracking here. https://stackoverflow.com/questions/5097808/is-document-referrer-cross-browser-compatible
      (window.appInsights = appInsights), appInsights.queue && 0 === appInsights.queue.length && appInsights.trackPageView();
    </script>
  </head>

  <body>
    <div id="main">
      <div class="loading">
        <img
          class="loadingImage"
          src="https://static2.sharepointonline.com/files/fabric/fabric-website/images/spinner.gif"
          alt="Loading"
          width="32"
          height="32"
        />
      </div>
    </div>

    <script type="text/javascript">
      var isLocal = window.location.hostname === 'localhost' || window.location.hostname.indexOf('ngrok.io') > -1;
      var isDogfood = false;
      var isProduction = false;

      // Query params
      var dogfoodParam = getParameterByName('isDogfood');
      var productionParam = getParameterByName('isProduction');
      var noCompress = isLocal || getParameterByName('noCompress');
      var devhost = getParameterByName('devhost');

      var entryPointFilename = 'fabric-site';
      var appPath = '';
      var Flight = {};

      // Determine production or staging/dogfood
      // @TODO: This will need to be switched out with developer.microsoft.com bits later
      if (location.hostname === 'uifabric.azurewebsites.net' || productionParam) {
        isProduction = true;
      } else if (location.hostname === 'uifabric-staging.azurewebsites.net' || dogfoodParam) {
        isDogfood = true;
      }

      // If hosted, load the flight config script for production or dogfood
      if (!isLocal) {
        // If a devhost is provided, override the config app path
        if (devhost) {
          appPath += devhost;
          Flight.baseCDNUrl = devhost;

          loadAppScripts(appPath);
        }

        // Load prod/DF bits
        else {
          var configPrefix = '';

          if (isProduction) {
            configPrefix = 'fabric-website-prod';
          } else if (isDogfood) {
            configPrefix = 'fabric-website-df';
          }

          var configScript = ['https://fabricweb.azureedge.net/fabric-website/manifests/' + configPrefix + '.js'];

          loadScripts(configScript, function() {
            if (window.Flight) {
              appPath += window.Flight.baseCDNUrl;

              loadAppScripts(appPath);
            }
          });
        }
      } else {
        // @TODO: Make sure we don't need to modify appPath on local
        // appPath += '/dist/';
        loadAppScripts(appPath);
      }

      function loadScripts(array, callback) {
        var loader = function(src, handler) {
          var script = document.createElement('script');
          script.src = src;
          script.onload = script.onreadystatechange = function() {
            script.onreadystatechange = script.onload = null;
            handler();
          };
          var head = document.getElementsByTagName('head')[0];
          (head || document.body).appendChild(script);
        };
        (function run() {
          if (array.length != 0) {
            loader(array.shift(), run);
          } else {
            callback && callback();
          }
        })();
      }

      function loadAppScripts(appPath) {
        var reactPath = '//cdnjs.cloudflare.com/ajax/libs/react/16.8.3/umd/react';
        var reactDomPath = '//cdnjs.cloudflare.com/ajax/libs/react-dom/16.8.3/umd/react-dom';

        if (noCompress) {
          reactPath = reactPath + '.development.js';
          reactDomPath = reactDomPath + '.development.js';
          appPath += entryPointFilename + '.js';
        } else {
          reactPath = reactPath + '.production.min.js';
          reactDomPath = reactDomPath + '.production.min.js';
          appPath += entryPointFilename + '.min.js';
        }

        var scripts = [reactPath, reactDomPath, appPath];

        // Load React and app scripts
        loadScripts(scripts);
      }

      function getParameterByName(name, url) {
        if (!url) {
          url = window.location.href;
        }
        name = name.replace(/[\[\]]/g, '\\$&');
        var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
          results = regex.exec(url);
        if (!results) return null;
        if (!results[2]) return '';
        return decodeURIComponent(results[2].replace(/\+/g, ' '));
      }
    </script>
  </body>
</html>
